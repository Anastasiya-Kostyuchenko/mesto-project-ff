{"version":3,"file":"main.js","mappings":"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","sources":["webpack://mesto-project-ff/./src/components/card.js","webpack://mesto-project-ff/./src/components/modal.js","webpack://mesto-project-ff/./src/validation.js","webpack://mesto-project-ff/./src/api.js","webpack://mesto-project-ff/./src/index.js"],"sourcesContent":["// Создание карточки с колбэками для событий\nexport function createCard(\n  template,\n  cardData,\n  userId,\n  { onLike, onUnlike, onDelete, onImageClick }\n) {\n  const cardElement = template.content\n    .querySelector(\".places__item\")\n    .cloneNode(true);\n  const cardImage = cardElement.querySelector(\".card__image\");\n  const likeCounter = cardElement.querySelector(\".card__like-counter\");\n  const likeButton = cardElement.querySelector(\".card__like-button\");\n  const deleteButton = cardElement.querySelector(\".card__delete-button\");\n\n  cardImage.setAttribute(\"src\", cardData.link);\n  cardImage.setAttribute(\"alt\", cardData.name);\n  cardElement.querySelector(\".card__title\").textContent = cardData.name;\n\n  const isLiked = cardData.likes.some((user) => user._id === userId);\n  if (isLiked) {\n    likeButton.classList.add(\"card__like-button_is-active\");\n  }\n\n  // Обновление счетчика лайков\n  if (likeCounter) {\n    likeCounter.textContent = cardData.likes.length;\n  } else {\n    console.error(\"Элемент likeCounter не найден\");\n  }\n\n  // Обработчик клика на кнопку лайка\n  likeButton.addEventListener(\"click\", () => {\n    const isLiked = likeButton.classList.contains(\n      \"card__like-button_is-active\"\n    );\n    const action = isLiked ? onUnlike : onLike;\n\n    action(cardData._id)\n      .then((updatedCardData) => {\n        likeButton.classList.toggle(\"card__like-button_is-active\", !isLiked);\n        if (likeCounter) {\n          likeCounter.textContent = updatedCardData.likes.length;\n        }\n      })\n      .catch((err) => {\n        console.error(`Ошибка при изменении лайка: ${err}`);\n      });\n  });\n\n  if (!deleteButton) {\n    console.error(\"Кнопка удаления не найдена\");\n    return cardElement;\n  }\n\n  if (cardData.owner._id === userId) {\n    deleteButton.addEventListener(\"click\", () => {\n      onDelete(cardData._id)\n        .then(() => {\n          cardElement.remove();\n        })\n        .catch((err) => {\n          console.error(`Ошибка при удалении карточки: ${err}`);\n        });\n    });\n  } else {\n    deleteButton.remove();\n  }\n\n  // Обработчик клика на изображение для открытия попапа\n  cardImage.addEventListener(\"click\", () => {\n    onImageClick(cardData);\n  });\n\n  return cardElement;\n}\n","let openedPopup = null; // Переменная для хранения открытого попапа\n\n// Универсальная функция открытия попапов\nexport function openPopup(popup) {\n  popup.classList.add(\"popup_is-opened\");\n  openedPopup = popup;\n  document.addEventListener(\"keydown\", handleEscClose);\n}\n\n// Универсальная функция закрытия попапов\n\nexport function closePopup(popup) {\n  popup.classList.remove(\"popup_is-opened\");\n  function handleTransitionEnd() {\n    popup.classList.remove(\"popup_is-opened\");\n    popup.removeEventListener(\"transitionend\", handleTransitionEnd);\n  }\n  popup.addEventListener(\"transitionend\", handleTransitionEnd);\n\n  openedPopup = null;\n  document.removeEventListener(\"keydown\", handleEscClose);\n}\n\n// Закрытие по клавише Escape\nexport function handleEscClose(evt) {\n  if (evt.key === \"Escape\") {\n    if (openedPopup) {\n      closePopup(openedPopup);\n    }\n  }\n}\n\nexport function setPopupListeners() {\n  // Закрытие попапа по клику на оверлей\n  const popups = document.querySelectorAll(\".popup\");\n  popups.forEach((popup) => {\n    popup.addEventListener(\"click\", (evt) => {\n      if (\n        evt.target === evt.currentTarget ||\n        evt.target.classList.contains(\"popup__close\")\n      ) {\n        closePopup(popup);\n      }\n    });\n  });\n}\n","// Функция для показа ошибки валидации\nexport function showInputError(\n  formElement,\n  inputElement,\n  errorMessage,\n  config\n) {\n  const errorElement = formElement.querySelector(`.${inputElement.name}-error`);\n  if (!errorElement) {\n    console.error(`Элемент ошибки для ${inputElement.name} не найден`);\n    return;\n  }\n  inputElement.classList.add(config.inputErrorClass);\n  errorElement.textContent = errorMessage;\n  errorElement.classList.add(config.errorClass);\n}\n\n// Функция для скрытия ошибки валидации\nexport function hideInputError(formElement, inputElement, config) {\n  const errorElement = formElement.querySelector(`.${inputElement.name}-error`);\n  inputElement.classList.remove(config.inputErrorClass);\n  errorElement.classList.remove(config.errorClass);\n  errorElement.textContent = \"\";\n}\n\n// Проверка поля на валидность\nexport function checkInputValidity(formElement, inputElement, config) {\n  const regex = /^[a-zA-Zа-яА-ЯёЁ\\s-]+$/;\n  const isNameOrTitleField =\n    inputElement.name === \"name\" ||\n    inputElement.name === \"place-name\" ||\n    inputElement.name === \"description\";\n\n  if (isNameOrTitleField && !regex.test(inputElement.value)) {\n    const errorMessage =\n      inputElement.dataset.errorMessage ||\n      \"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы\";\n    inputElement.setCustomValidity(errorMessage);\n  } else {\n    inputElement.setCustomValidity(\"\");\n  }\n\n  // Отображение ошибки или её скрытие\n  if (!inputElement.validity.valid) {\n    showInputError(\n      formElement,\n      inputElement,\n      inputElement.validationMessage,\n      config\n    );\n  } else {\n    hideInputError(formElement, inputElement, config);\n  }\n}\n\n// Проверка состояния кнопки отправки\nexport function toggleButtonState(inputList, buttonElement, config) {\n  const isFormValid = inputList.every(\n    (inputElement) => inputElement.validity.valid\n  );\n\n  if (isFormValid) {\n    buttonElement.disabled = false;\n    buttonElement.classList.remove(config.inactiveButtonClass);\n  } else {\n    buttonElement.disabled = true;\n    buttonElement.classList.add(config.inactiveButtonClass);\n  }\n}\n\n// Навешиваем обработчики событий на форму\nexport function setEventListeners(formElement, config, renderLoading) {\n  const inputList = Array.from(\n    formElement.querySelectorAll(config.inputSelector)\n  );\n  const buttonElement = formElement.querySelector(config.submitButtonSelector);\n\n  inputList.forEach((inputElement) => {\n    inputElement.addEventListener(\"input\", () => {\n      checkInputValidity(formElement, inputElement, config);\n      toggleButtonState(inputList, buttonElement, config);\n    });\n  });\n}\n\n// Функция включения валидации\nexport function enableValidation(config, renderLoading) {\n  const formList = Array.from(document.querySelectorAll(config.formSelector));\n\n  formList.forEach((formElement) => {\n    formElement.addEventListener(\"submit\", (evt) => {\n      evt.preventDefault();\n\n      const buttonElement = formElement.querySelector(\n        config.submitButtonSelector\n      );\n      renderLoading(true, buttonElement);\n    });\n\n    setEventListeners(formElement, config, renderLoading);\n  });\n}\n\n// Очистка ошибок валидации и сброс состояния кнопки\nexport function clearValidation(formElement, config, renderLoading) {\n  const inputList = Array.from(\n    formElement.querySelectorAll(config.inputSelector)\n  );\n  const buttonElement = formElement.querySelector(config.submitButtonSelector);\n\n  inputList.forEach((inputElement) => {\n    hideInputError(formElement, inputElement, config);\n    inputElement.value = \"\";\n  });\n\n  toggleButtonState(inputList, buttonElement, config);\n}\n","export const cohortId = \"wff-cohort-24\";\nexport const apiToken = \"1f0c507e-d045-450a-a244-e6e5498819e0\";\n\n// Функция для проверки ответа сервера\nexport function checkResponse(res) {\n  if (res.ok) {\n    return res.json();\n  }\n  return Promise.reject(`Ошибка: ${res.status}`);\n}\n\n// Получение данных пользователя с сервера\nexport function getUserInfo() {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/users/me`, {\n    headers: {\n      authorization: apiToken,\n    },\n  }).then(checkResponse);\n}\n\n// Обновление данных профиля\nexport function updateProfile(name, about) {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/users/me`, {\n    method: \"PATCH\",\n    headers: {\n      authorization: apiToken,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      name: name,\n      about: about,\n    }),\n  }).then(checkResponse);\n}\n\n// Получение всех карточек\nexport function getCards() {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/cards`, {\n    headers: {\n      authorization: apiToken,\n    },\n  }).then(checkResponse);\n}\n\n// Добавление новой карточки функция\nexport function addCard(name, link) {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/cards`, {\n    method: \"POST\",\n    headers: {\n      authorization: apiToken,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      name: name,\n      link: link,\n    }),\n  }).then(checkResponse);\n}\n\n// Удаление карточки\nexport function deleteCard(cardId) {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/cards/${cardId}`, {\n    method: \"DELETE\",\n    headers: {\n      authorization: apiToken,\n    },\n  }).then(checkResponse);\n}\n\n// Функция для постановки лайка\nexport function likeCard(cardId) {\n  return fetch(\n    `https://nomoreparties.co/v1/${cohortId}/cards/likes/${cardId}`,\n    {\n      method: \"PUT\",\n      headers: {\n        authorization: apiToken,\n      },\n    }\n  ).then(checkResponse);\n}\n\n// Функция для снятия лайка\nexport function unlikeCard(cardId) {\n  return fetch(\n    `https://nomoreparties.co/v1/${cohortId}/cards/likes/${cardId}`,\n    {\n      method: \"DELETE\",\n      headers: {\n        authorization: apiToken,\n      },\n    }\n  ).then(checkResponse);\n}\n\n// Получение данных пользователя\n\nexport function getUserProfile(cohortId, apiToken) {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/users/me`, {\n    method: \"GET\",\n    headers: {\n      authorization: apiToken,\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(checkResponse);\n}\n\nexport function updateAvatar(cohortId, apiToken, newAvatarUrl) {\n  return fetch(`https://nomoreparties.co/v1/${cohortId}/users/me/avatar`, {\n    method: \"PATCH\",\n    headers: {\n      authorization: apiToken,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ avatar: newAvatarUrl }),\n  }).then(checkResponse);\n}\n","import \"./index.css\";\nimport { createCard } from \"./components/card.js\";\nimport {\n  openPopup,\n  closePopup,\n  setPopupListeners,\n} from \"./components/modal.js\";\nimport {\n  enableValidation,\n  clearValidation,\n  showInputError,\n  hideInputError,\n  checkInputValidity,\n  toggleButtonState,\n  setEventListeners,\n} from \"./validation.js\";\nimport {\n  getUserInfo,\n  getCards,\n  updateProfile,\n  addCard,\n  checkResponse,\n  cohortId,\n  apiToken,\n  deleteCard,\n  likeCard,\n  unlikeCard,\n  getUserProfile,\n  updateAvatar,\n} from \"./api.js\";\n\n// Переменные\nconst cardTemplate = document.querySelector(\"#card-template\");\nconst placesList = document.querySelector(\".places__list\");\nconst editPopup = document.querySelector(\".popup_type_edit\");\nconst addCardPopup = document.querySelector(\".popup_type_new-card\");\nconst editButton = document.querySelector(\".profile__edit-button\");\nconst addButton = document.querySelector(\".profile__add-button\");\nconst editProfileForm = editPopup.querySelector(\".popup__form\");\nconst addCardForm = addCardPopup.querySelector(\".popup__form\");\nconst nameInput = document.querySelector(\".popup__input_type_name\");\nconst jobInput = document.querySelector(\".popup__input_type_description\");\nconst profileName = document.querySelector(\".profile__title\");\nconst profileJob = document.querySelector(\".profile__description\");\nconst cardNameInput = document.querySelector(\".popup__input_type_card-name\");\nconst cardUrlInput = document.querySelector(\".popup__input_type_url\");\nconst cardForm = document.querySelector('form[name=\"new-place\"]');\nconst imagePopup = document.querySelector(\".popup_type_image\");\nconst imageElement = imagePopup.querySelector(\".popup__image\");\nconst captionElement = imagePopup.querySelector(\".popup__caption\");\n\nconst profileImage = document.querySelector(\".profile__image\");\n\nconst config = {\n  formSelector: \".popup__form\",\n  inputSelector: \".popup__input\",\n  submitButtonSelector: \".popup__button\",\n  inactiveButtonClass: \"popup__button_disabled\",\n  inputErrorClass: \"popup__input_type_error\",\n  errorClass: \"popup__error_visible\",\n};\n\nsetPopupListeners();\n\n// Обработчик открытия попапа редактирования профиля\neditButton.addEventListener(\"click\", () => {\n  nameInput.value = profileName.textContent;\n  jobInput.value = profileJob.textContent;\n  clearValidation(editProfileForm, config);\n  openPopup(editPopup);\n});\n\n// Обработчик сохранения данных профиля\neditProfileForm.addEventListener(\"submit\", (evt) => {\n  evt.preventDefault();\n  renderLoading(true, avatarSubmitButton, \"Сохранение...\");\n  updateProfile(nameInput.value, jobInput.value)\n    .then((updatedUserData) => {\n      profileName.textContent = updatedUserData.name;\n      profileJob.textContent = updatedUserData.about;\n      closePopup(editPopup);\n    })\n    .catch((err) => {\n      console.error(`Ошибка обновления профиля: ${err}`);\n    })\n    .finally(() => {\n      renderLoading(false, avatarSubmitButton, \"Сохранить\");\n    });\n});\n\n// Обработчик открытия попапа добавления карточки\naddButton.addEventListener(\"click\", () => {\n  clearValidation(addCardForm, config);\n  openPopup(addCardPopup);\n});\n\nlet userId;\n\nPromise.all([getUserInfo(), getCards()]).then(([userData, cards]) => {\n  profileName.textContent = userData.name;\n  profileJob.textContent = userData.about;\n  profileImage.style.backgroundImage = `url('${userData.avatar}')`;\n  if (!Array.isArray(cards)) {\n    console.error(\"cards не является массивом\");\n    return;\n  }\n\n  // Отображение карточек на странице\n  cards.forEach((card) => {\n    const cardElement = createCard(cardTemplate, card, userData._id, {\n      onLike: likeCard,\n      onUnlike: unlikeCard,\n      onDelete: deleteCard,\n    });\n    placesList.append(cardElement);\n  });\n  userId = userData._id;\n});\n\n// Обработчик добавления новой карточки\ncardForm.addEventListener(\"submit\", (evt) => {\n  evt.preventDefault();\n  renderLoading(true, avatarSubmitButton, \"Сохранение...\");\n\n  addCard(cardNameInput.value, cardUrlInput.value)\n    .then((newCardData) => {\n      const cardElement = createCard(cardTemplate, newCardData, userId, {\n        onLike: likeCard,\n        onUnlike: unlikeCard,\n        onDelete: deleteCard,\n      });\n      placesList.prepend(cardElement);\n      closePopup(addCardPopup);\n      cardForm.reset();\n    })\n    .catch((err) => {\n      console.error(`Ошибка добавления карточки: ${err}`);\n    })\n    .finally(() => {\n      renderLoading(false, avatarSubmitButton, \"Сохранить\");\n    });\n});\n\nconst avatarPopup = document.querySelector(\".popup_type_avatar\");\nconst avatarOpenButton = document.querySelector(\".profile__image\");\nconst avatarCloseButton = avatarPopup.querySelector(\".popup__close\");\nconst avatarForm = document.querySelector('form[name=\"avatar-form\"]');\nconst avatarSubmitButton = avatarForm.querySelector(\".popup__button\");\n\n// Открытие попапа\navatarOpenButton.addEventListener(\"click\", () => {\n  openPopup(avatarPopup);\n  avatarSubmitButton.disabled = true;\n  avatarSubmitButton.classList.add(config.inactiveButtonClass);\n});\n\n// Закрытие попапа\navatarCloseButton.addEventListener(\"click\", () => {\n  closePopup(avatarPopup);\n  avatarForm.reset();\n  avatarSubmitButton.disabled = true;\n  avatarSubmitButton.classList.add(config.inactiveButtonClass);\n});\n\n// Функция для проверки валидности URL\nfunction isValidURL(url) {\n  const urlPattern =\n    /^(http:\\/\\/|https:\\/\\/)([\\w\\-]+\\.)+[\\w]{2,}(\\/[\\w\\-.~:?#[\\]@!$&'()*+,;=]*)*\\/?$/i;\n  return urlPattern.test(url);\n}\n\n// Функция для отображения состояния загрузки\nfunction renderLoading(isLoading, buttonElement, defaultText = \"Сохранить\") {\n  if (isLoading) {\n    buttonElement.textContent = \"Сохранение...\";\n    buttonElement.disabled = true;\n  } else {\n    buttonElement.textContent = defaultText;\n    buttonElement.disabled = false;\n  }\n}\n\nenableValidation(config, renderLoading);\n\n// Проверка валидности URL перед отправкой\navatarForm.addEventListener(\"submit\", (event) => {\n  event.preventDefault();\n\n  const avatarInput = avatarForm.querySelector(\".popup__input_type_avatar\");\n  const newAvatarUrl = avatarInput.value;\n\n  renderLoading(true, avatarSubmitButton, \"Сохранение...\");\n\n  updateAvatar(cohortId, apiToken, newAvatarUrl)\n    .then((data) => {\n      profileImage.style.backgroundImage = `url('${newAvatarUrl}')`;\n      closePopup(avatarPopup);\n    })\n    .catch((err) => {\n      console.error(`Ошибка при смене аватара: ${err}`);\n      const errorElement = document.querySelector(\".avatar-error\");\n      errorElement.textContent = \"Не удалось сменить аватар. Попробуйте снова.\";\n    })\n    .finally(() => {\n      renderLoading(false, avatarSubmitButton, \"Сохранить\");\n    });\n});\n"],"names":["createCard","template","cardData","userId","_ref","onLike","onUnlike","onDelete","onImageClick","cardElement","content","querySelector","cloneNode","cardImage","likeCounter","likeButton","deleteButton","setAttribute","link","name","textContent","likes","some","user","_id","classList","add","length","console","error","addEventListener","isLiked","contains","then","updatedCardData","toggle","catch","err","concat","owner","remove","openedPopup","openPopup","popup","document","handleEscClose","closePopup","handleTransitionEnd","removeEventListener","evt","key","hideInputError","formElement","inputElement","config","errorElement","inputErrorClass","errorClass","toggleButtonState","inputList","buttonElement","every","validity","valid","disabled","inactiveButtonClass","clearValidation","renderLoading","Array","from","querySelectorAll","inputSelector","submitButtonSelector","forEach","value","cohortId","apiToken","checkResponse","res","ok","json","Promise","reject","status","deleteCard","cardId","fetch","method","headers","authorization","likeCard","unlikeCard","cardTemplate","placesList","editPopup","addCardPopup","editButton","addButton","editProfileForm","addCardForm","nameInput","jobInput","profileName","profileJob","cardNameInput","cardUrlInput","cardForm","imagePopup","profileImage","formSelector","target","currentTarget","about","preventDefault","avatarSubmitButton","body","JSON","stringify","updatedUserData","finally","all","_ref2","userData","cards","style","backgroundImage","avatar","isArray","card","append","newCardData","prepend","reset","avatarPopup","avatarOpenButton","avatarCloseButton","avatarForm","isLoading","defaultText","arguments","undefined","test","setCustomValidity","errorMessage","dataset","showInputError","validationMessage","checkInputValidity","setEventListeners","enableValidation","event","newAvatarUrl","updateAvatar","data"],"sourceRoot":""}